# 🤖 Auto 모드 사용 가이드

완전 자동 거래 시스템!

---

## 🎯 Auto 모드란?

**자동으로:**
- ✅ 15분 BTC/USD 마켓 모니터링
- ✅ 거래 조건 검증 ($200 갭)
- ✅ 최적 타이밍에 자동 거래
- ✅ 텔레그램으로 실시간 알림
- ✅ 킬스위치로 긴급 중지

**수동 거래 vs Auto 모드:**

| 기능 | 수동 | Auto |
|------|------|------|
| 마켓 확인 | 본인 | 자동 |
| 조건 검증 | 본인 | 자동 |
| 거래 실행 | 버튼 클릭 | 자동 |
| 모니터링 | 24시간 필요 | 봇이 수행 |
| 알림 | 없음 | 텔레그램 |

---

## 🚀 시작하기

### Step 1: 텔레그램 봇 설정 (필수)

Auto 모드는 텔레그램 봇이 **필수**입니다!

```
→ TELEGRAM_SETUP.md 참고
→ BOT_TOKEN과 CHAT_ID 설정
→ 5분이면 완료!
```

### Step 2: 대시보드 열기

```
http://localhost:5000
```

### Step 3: Shares 수량 설정

```
기본값: 10 shares
권장: 처음엔 1-2 shares로 테스트
```

### Step 4: Auto 모드 시작!

```
"🤖 Auto 모드 시작" 버튼 클릭
```

**성공하면:**
- ✅ 버튼이 "🛑 Auto 모드 중지"로 변경
- ✅ Auto 모드 통계 섹션 표시
- ✅ 텔레그램 알림: "🤖 Auto 모드 시작"

---

## 📊 Auto 모드 동작 원리

### 1. 마켓 모니터링 (10초마다)

```python
while True:
    1. 현재 15분 마켓 가져오기
    2. 마켓 종료 5분 전인지 확인
    3. BTC 가격 갭 $200 이상인지 확인
    4. 조건 충족 → 거래 실행
    5. 10초 대기
```

### 2. 거래 조건

**모두 충족해야 함:**
- ⏰ 마켓 종료 5분 전 (300초)
- 📊 가격 갭 ≥ $200 (UP) 또는 ≤ -$200 (DOWN)
- 💰 충분한 잔액
- 🕐 마지막 거래로부터 60초 경과 (쿨다운)

### 3. 자동 거래 실행

```
조건 충족 시:
1. 텔레그램 알림: "🎯 거래 가능 마켓 발견"
2. 오더북 가져오기
3. Maker 가격 계산 (1틱 낮게)
4. 계정 배정 (잔액 우선순위)
5. Maker 주문 실행
6. 2초 대기
7. Taker 주문 실행
8. 결과 알림
```

### 4. 쿨다운 (60초)

```
거래 후 60초 동안 대기
→ 과도한 거래 방지
→ 수수료 최소화
```

---

## 🎛️ 제어 방법

### 대시보드에서

**중지:**
```
"🛑 Auto 모드 중지" 버튼 클릭
→ 즉시 중지
```

**재시작:**
```
"🤖 Auto 모드 시작" 버튼 다시 클릭
```

### 텔레그램에서 (킬스위치!)

**긴급 중지:**
```
/stop

→ 모든 자동 거래 즉시 중단
→ 안전장치!
```

**재개:**
```
/resume

→ Auto 모드 다시 활성화
```

**상태 확인:**
```
/status

→ 현재 실행 중인지 확인
```

---

## 📈 통계 확인

대시보드 "🤖 Auto 모드 통계" 섹션:

### 상태
```
▶️ 실행 중  또는  ⏸️ 정지됨
```

### 총 거래
```
지금까지 실행한 총 거래 수
```

### 성공 / 실패
```
성공한 거래 vs 실패한 거래
```

### 승률
```
(성공 / 총 거래) × 100%
목표: 95% 이상
```

---

## ⚠️ 주의사항

### 1. 잔액 확인

```
Auto 모드는 자동으로 거래하므로:
→ 충분한 잔액 유지 ($20 이상)
→ 잔액 부족 시 텔레그램 알림
```

### 2. 네트워크 연결

```
→ 안정적인 인터넷 필요
→ 서버 항상 실행 중이어야 함
→ Vercel 배포 권장 (24/7)
```

### 3. API 제한

```
→ Predict.fun API 호출 제한 확인
→ 10초 간격으로 체크 (안전)
```

### 4. 쿨다운 준수

```
→ 거래 후 60초 대기
→ 변경 가능 (config.py)
```

---

## 🔧 커스터마이징

### config.py에서 수정 가능:

```python
# 체크 간격 (기본: 10초)
check_interval = 10

# 쿨다운 (기본: 60초)
trade_cooldown = 60

# 최소 가격 갭 (기본: $200)
MIN_PRICE_GAP = 200

# 마켓 종료 전 진입 시간 (기본: 300초 = 5분)
TIME_BEFORE_END = 300
```

### auto_trader.py에서 수정:

```python
# 더 공격적으로: 짧은 간격
self.check_interval = 5  # 5초마다

# 더 보수적으로: 긴 쿨다운
self.trade_cooldown = 120  # 2분 쿨다운
```

---

## 📱 텔레그램 알림 예시

### 시작
```
🤖 Auto 모드 시작

Shares: 10
체크 간격: 10초
```

### 마켓 발견
```
🎯 거래 가능 마켓 발견

마켓: BTC/USD Up/Down 15min
방향: UP
가격 갭: +$250.00
남은 시간: 120초
```

### 거래 성공
```
✅ 거래 실행 완료

방향: UP
가격: $0.88
수량: 10 shares
시간: 14:23:45
```

### 거래 실패
```
❌ 거래 실패

에러: Insufficient balance
시간: 14:25:30
```

---

## 🐛 문제 해결

### "Auto mode already running"

```
→ 이미 실행 중
→ 먼저 중지 후 재시작
```

### 거래가 안 됨

```
체크리스트:
□ Auto 모드 실행 중?
□ 잔액 충분?
□ 거래 조건 충족? ($200 갭)
□ 쿨다운 끝남? (60초)
□ 마켓 종료 5분 전?
```

### 텔레그램 알림이 안 옴

```
→ BOT_TOKEN 확인
→ CHAT_ID 확인
→ 봇에게 /start 보냈는지 확인
→ TELEGRAM_SETUP.md 참고
```

### 너무 많은 거래

```
→ trade_cooldown 늘리기
→ MIN_PRICE_GAP 높이기 (예: $300)
```

---

## 💡 팁 & 트릭

### 1. 테스트 모드

```python
# auto_trader.py
self.shares_per_trade = 1  # 1 share로 테스트

# 실제 거래 없이 로그만
if TEST_MODE:
    logger.info("TEST: Would execute trade here")
    return
```

### 2. 승률 높이기

```python
# 더 안전한 갭 요구
MIN_PRICE_GAP = 300  # $300

# 더 늦게 진입
TIME_BEFORE_END = 180  # 3분 전
```

### 3. 24/7 운영

```
→ Vercel에 배포
→ 또는 클라우드 서버 (AWS, GCP)
→ 또는 홈 서버 (Raspberry Pi)
```

### 4. 로그 저장

```python
# 로그 파일로 저장
import logging

logging.basicConfig(
    filename='auto_trades.log',
    level=logging.INFO
)
```

---

## 📊 성능 모니터링

### 매일 체크할 것:

```
□ 승률 95% 이상?
□ 잔액 충분?
□ 텔레그램 봇 작동?
□ 서버 실행 중?
```

### 매주 체크할 것:

```
□ 총 수익 계산
□ 수수료 대비 리워드
□ 실패 원인 분석
□ 설정 최적화
```

---

## 🎉 완료!

Auto 모드가 준비되었습니다!

**다음 단계:**
1. ✅ 텔레그램 봇 설정
2. ✅ 소액으로 테스트 (1-2 shares)
3. ✅ 24시간 모니터링
4. ✅ 설정 최적화
5. ✅ 수익 확인!

**화이팅!** 🚀
